From 56f1a13e455787ba2172b471517db80a707f8ba5 Mon Sep 17 00:00:00 2001
From: John Crispin <john@phrozen.org>
Date: Mon, 21 Sep 2020 13:38:53 +0200
Subject: [PATCH 807/813] co-located: add a config option to indicate co locate

A 6GHz BSS can be co-located with a 2/5GHz BSS. This option allows us to
indicate if this should be done.

Signed-off-by: John Crispin <john@phrozen.org>
---
 hostapd/config_file.c | 2 ++
 hostapd/hostapd.conf  | 3 +++
 src/ap/ap_config.h    | 1 +
 3 files changed, 6 insertions(+)

diff --git a/hostapd/config_file.c b/hostapd/config_file.c
index e66790303..9db6d159a 100644
--- a/hostapd/config_file.c
+++ b/hostapd/config_file.c
@@ -3552,6 +3552,8 @@ static int hostapd_config_fill(struct hostapd_config *conf,
 		conf->he_oper_centr_freq_seg0_idx = atoi(pos);
 	} else if (os_strcmp(buf, "he_oper_centr_freq_seg1_idx") == 0) {
 		conf->he_oper_centr_freq_seg1_idx = atoi(pos);
+	} else if (os_strcmp(buf, "he_co_locate") == 0) {
+		conf->he_co_locate = atoi(pos);
 #endif /* CONFIG_IEEE80211AX */
 	} else if (os_strcmp(buf, "max_listen_interval") == 0) {
 		bss->max_listen_interval = atoi(pos);
diff --git a/hostapd/hostapd.conf b/hostapd/hostapd.conf
index 5fc4d5f86..280316c0c 100644
--- a/hostapd/hostapd.conf
+++ b/hostapd/hostapd.conf
@@ -571,6 +571,9 @@ wmm_ac_vo_acm=0
 # Default: 1 (enabled)
 #broadcast_deauth=1
 
+# Enable co-locate for a 6GHz radio
+#co_locate=0
+
 ##### IEEE 802.11n related configuration ######################################
 
 # ieee80211n: Whether IEEE 802.11n (HT) is enabled
diff --git a/src/ap/ap_config.h b/src/ap/ap_config.h
index bf7645d23..c811708fc 100644
--- a/src/ap/ap_config.h
+++ b/src/ap/ap_config.h
@@ -1031,6 +1031,7 @@ struct hostapd_config {
 	u8 he_oper_chwidth;
 	u8 he_oper_centr_freq_seg0_idx;
 	u8 he_oper_centr_freq_seg1_idx;
+	bool he_co_locate;
 #endif /* CONFIG_IEEE80211AX */
 
 	/* VHT enable/disable config from CHAN_SWITCH */
-- 
2.25.1

